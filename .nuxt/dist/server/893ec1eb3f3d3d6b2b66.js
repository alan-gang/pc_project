exports.ids=[10],exports.modules={100:function(e,t,o){"use strict";t.a={data:()=>({}),methods:{alert(e,t="warning",o=2e3){this.$message({message:e,type:t,duration:o})},confirm(e,t="warning",o){this.$alert(e,"温馨提示",{confirmButtonText:"确定",type:t,callback:o})},prompt(e,t){this.$confirm(e,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",closeOnClickModal:!1,type:"warning"}).then(t).catch(()=>{this.$message({type:"success",message:"您是对的，三思而后行",duration:1e3})})}}}},106:function(e,t){e.exports={}},107:function(e,t){e.exports={}},110:function(e,t,o){"use strict";var n=o(36),r=o(37),c=o(100),l={mixins:[r.a,c.a],props:{identity:String,email:String,type:String,mobile:String,isValidate:Boolean},data:()=>({isSend:!1,countDown:0,timer:null,url:null,msg:null,sendData:null}),methods:{async _getCode(){if("email"==this.type?(this.msg="请先输入邮箱并确认身份",this.url=n.g,this.sendData={email:this.email,identity:this.identity}):(this.msg="请输入正确的手机号码",this.url=n.e,this.sendData={mobile:this.mobile,identity:this.identity}),!this.isValidate||!this.identity)return void this.alert(this.msg);this.isSend=!0,this.countDown=5,this.timer=setInterval(()=>{if(this.countDown<1)return clearInterval(this.timer),void(this.isSend=!1);this.countDown--},1e3);let{code:code,data:data,status:e,message:t}=await this.url(this.sendData);0==code&&this.alert(data.msg,1==this.identity?"success":"warning")}}},m=o(1);var component=Object(m.a)(l,(function(){var e=this.$createElement;return(this._self._c||e)("el-button",{attrs:{type:"primary",loading:this.isSend},on:{click:this._getCode}},[this._v("\n  "+this._s(this.isSend?this.countDown+" 秒后从新获取":"发送"+("email"==this.type?"邮箱":"手机")+"验证码")+"\n")])}),[],!1,(function(e){}),"06bf4d22","1cdfa99c");t.a=component.exports},116:function(e,t,o){"use strict";o.r(t);var n=o(106),r=o.n(n);for(var c in n)"default"!==c&&function(e){o.d(t,e,(function(){return n[e]}))}(c);t.default=r.a},117:function(e,t,o){"use strict";o.r(t);var n=o(107),r=o.n(n);for(var c in n)"default"!==c&&function(e){o.d(t,e,(function(){return n[e]}))}(c);t.default=r.a},120:function(e,t,o){"use strict";o.r(t);o(3);var n=o(37),r=o(100),c=o(36);const l=e=>{0};var m={props:{activeNames:String,isDisabled:Boolean,index:String}},d=o(1);var f=Object(d.a)(m,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"btn-group mt_20"},[o("el-button",{attrs:{size:"small",type:"primary",disabled:e.activeNames==e.index&&e.isDisabled},on:{click:function(t){return e.$emit("uodateUser")}}},[e._v("确定")]),e._ssrNode(" "),o("el-button",{attrs:{size:"small"},on:{click:function(t){return e.$emit("changeActive")}}},[e._v("取消")])],2)}),[],!1,(function(e){var t=o(116);t.__inject__&&t.__inject__(e)}),"36c8d4ad","071385c4").exports,v=o(110),h={mixins:[n.a,r.a],components:{btnGroup:f,getCode:v.a},mounted(){this.$nextTick(()=>{this.useNameLogin=l().hasOwnProperty("accountName")})},data(){return{activeNames:"0",isDisabled:!0,useNameLogin:!1,emailValidator:!1,isValidateMobile:!1,temporaryPassword:null,form:JSON.parse(JSON.stringify(this.$store.state.user.UserInfo)),isShowPassword:!1}},methods:{async _updateUser(e,data){if(e.every(e=>"success"===this.$refs[e].validateState)){data.password&&(data.password=await this._getPublicKey(data.password),this.temporaryPassword=data.newPassword=await this._getPublicKey(data.newPassword),this.form.oldPassword="",this.form.newPassword="",this.form.checkPassword="");let t=await Object(c.m)(data);if(0!=t.code)return;(data.accountName||this.temporaryPassword||this.form.email)&&this.isSaveUserName(e.length),sessionStorage.token=t.data.token,this.$store.commit("user/saveUserInfo",t.data.user),this.alert(t.data.msg,"success"),this.activeNames="0",this.isDisabled=!0}else this.alert("请检查表单后在进行数据提交")},isSaveUserName(e){let t={accountName:this.form.accountName,email:this.form.email};e>1&&(t.password=this.temporaryPassword);let o=l();o&&o.hasOwnProperty("accountName")&&!this.useNameLogin&&(delete t.accountName,delete o.accountName),Object.assign(o||{password:this.form.password},t)},async _destoryUser(){this.prompt("此操作将永久删除用户信息,是否继续？",async()=>{let e=await Object(c.b)({_id:this.$store.state.user.UserInfo._id});0==e.code?(this.alert("删除用户成功","error",2e3),this.$router.replace("/user/register")):this.alert(e.message)})}},computed:{showErrorMessage(){return Boolean(this.activeNames)}}};var _=Object(d.a)(h,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"account-container w_840"},[o("el-form",{attrs:{"label-position":"top","label-width":"80px",model:e.form,"show-message":e.showErrorMessage,rules:e.rules}},[o("div",{staticClass:"title-container ft_24 c_6 ft_b mt_30 "},[e._v("账户与安全")]),e._v(" "),o("el-collapse",{attrs:{accordion:!0},on:{change:function(t){e.isDisabled=!0}},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[o("el-collapse-item",{staticClass:"mt_30",attrs:{name:"1"}},[o("template",{slot:"title"},[o("el-form-item",{ref:"accountName",staticClass:"w_100p",attrs:{prop:"accountName",label:"用户名"}},[o("el-input",{class:{on:"1"==e.activeNames},attrs:{"suffix-icon":"icon iconfont icon-write_fill",placeholder:"请输入用户名"},on:{input:function(t){e.isDisabled=!1,e.activeNames="1"}},model:{value:e.form.accountName,callback:function(t){e.$set(e.form,"accountName",t)},expression:"form.accountName"}})],1)],1),e._v(" "),o("div",{staticClass:"mt_25"},[o("div",{staticClass:"operate-container"},[o("el-switch",{attrs:{"active-text":"使用用户名作为登录凭证"},model:{value:e.useNameLogin,callback:function(t){e.useNameLogin=t},expression:"useNameLogin"}})],1),e._v(" "),o("btn-group",{attrs:{activeNames:e.activeNames,isDisabled:e.isDisabled,index:"1"},on:{uodateUser:function(t){return e._updateUser(["accountName"],{accountName:e.form.accountName})},changeActive:function(t){e.activeNames="0"}}})],1)],2),e._v(" "),o("el-collapse-item",{staticClass:"mt_30",attrs:{name:"2"}},[o("template",{slot:"title"},[o("el-form-item",{ref:"oldPassword",staticClass:"w_100p",attrs:{prop:"oldPassword",label:"密码"}},[o("el-input",{class:{on:"2"==e.activeNames},attrs:{"suffix-icon":"icon iconfont icon-write_fill",placeholder:"修改密码前需要输入当前密码",type:"password"},on:{input:function(t){e.isDisabled=!1,e.activeNames="2"}},model:{value:e.form.oldPassword,callback:function(t){e.$set(e.form,"oldPassword",t)},expression:"form.oldPassword"}})],1)],1),e._v(" "),o("div",{staticClass:"mt_25 "},[o("div",{staticClass:"operate-container"},[o("el-form-item",{ref:"newPassword",attrs:{prop:"newPassword"}},[o("el-input",{attrs:{type:e.isShowPassword?"text":"password",placeholder:"新密码"},on:{input:function(t){e.isDisabled=!1,e.activeNames="2"}},model:{value:e.form.newPassword,callback:function(t){e.$set(e.form,"newPassword",t)},expression:"form.newPassword"}},[o("span",{staticClass:"icon iconfont icon-eye ft_18 c_r",attrs:{slot:"suffix"},on:{click:function(t){e.isShowPassword=!e.isShowPassword}},slot:"suffix"})])],1),e._v(" "),o("el-form-item",{ref:"checkPassword",attrs:{prop:"checkPassword"}},[o("el-input",{attrs:{type:e.isShowPassword?"text":"password",placeholder:"确认新密码"},on:{input:function(t){e.isDisabled=!1,e.activeNames="2"}},model:{value:e.form.checkPassword,callback:function(t){e.$set(e.form,"checkPassword",t)},expression:"form.checkPassword"}},[o("span",{staticClass:"icon iconfont icon-eye ft_18 c_r",attrs:{slot:"suffix"},on:{click:function(t){e.isShowPassword=!e.isShowPassword}},slot:"suffix"})])],1)],1),e._v(" "),o("div",{staticClass:"flex  j_s "},[o("btn-group",{attrs:{activeNames:e.activeNames,isDisabled:e.isDisabled,index:"2"},on:{uodateUser:function(t){return e._updateUser(["oldPassword","newPassword","checkPassword"],{password:e.form.oldPassword,newPassword:e.form.newPassword})},changeActive:function(t){e.activeNames="0"}}}),e._v(" "),o("nuxt-link",{staticClass:"f_x_e ml_20 c_tc",attrs:{to:"/user/resetpassword"}},[e._v("忘记密码")])],1)])],2),e._v(" "),o("el-collapse-item",{staticClass:"mt_30",attrs:{name:"3"}},[o("template",{slot:"title"},[o("el-form-item",{ref:"nickName",staticClass:"w_100p",attrs:{label:"昵称",prop:"nickName"}},[o("el-input",{class:{on:"3"==e.activeNames},attrs:{"suffix-icon":"icon iconfont icon-write_fill",placeholder:"请输入用户昵称"},on:{input:function(t){e.isDisabled=!1,e.activeNames="3"}},model:{value:e.form.nickName,callback:function(t){e.$set(e.form,"nickName",t)},expression:"form.nickName"}})],1)],1),e._v(" "),o("btn-group",{staticClass:"mt_30",attrs:{activeNames:e.activeNames,isDisabled:e.isDisabled,index:"3"},on:{uodateUser:function(t){return e._updateUser(["nickName"],{nickName:e.form.nickName})},changeActive:function(t){e.activeNames="0"}}})],2),e._v(" "),o("el-collapse-item",{staticClass:"mt_30",attrs:{name:"4"}},[o("template",{slot:"title"},[o("el-form-item",{ref:"email",staticClass:"w_100p",attrs:{label:"绑定邮箱",prop:"email"}},[o("el-input",{class:{on:"4"==e.activeNames},attrs:{"suffix-icon":"icon iconfont icon-write_fill",placeholder:"请输入需要修改的邮箱"},on:{input:function(t){e.isDisabled=!1,e.activeNames="4"}},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1)],1),e._v(" "),o("div",{staticClass:"mt_25 "},[o("div",{staticClass:"operate-container"},[o("el-form-item",{attrs:{prop:"code"}},[o("el-input",{attrs:{placeholder:"请输入获取到的验证码"},on:{input:function(t){e.isDisabled=!1,e.activeNames="4"}},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}},[o("template",{slot:"append"},[o("get-code",{attrs:{isValidate:e.emailValidator,type:"email",identity:e.form.identity,email:e.form.email}})],1)],2)],1)],1),e._v(" "),o("btn-group",{staticClass:"mt_30",attrs:{activeNames:e.activeNames,isDisabled:e.isDisabled,index:"4"},on:{uodateUser:function(t){return e._updateUser(["email"],{email:e.form.email})},changeActive:function(t){e.activeNames="0"}}})],1)],2),e._v(" "),o("el-collapse-item",{staticClass:"mt_30",attrs:{name:"5"}},[o("template",{slot:"title"},[o("el-form-item",{ref:"mobile",staticClass:"w_100p",attrs:{label:"手机号码",prop:"mobile"}},[o("el-input",{class:{on:"5"==e.activeNames},attrs:{"suffix-icon":"icon iconfont icon-write_fill",placeholder:"请输入手机号码"},on:{input:function(t){e.isDisabled=!1,e.activeNames="5"}},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1)],1),e._v(" "),o("div",{staticClass:"mt_30 "},[o("div",{staticClass:"operate-container"},[o("el-form-item",{attrs:{prop:"mobileCode"}},[o("el-input",{attrs:{placeholder:"请输入获取到的验证码"},on:{input:function(t){e.isDisabled=!1,e.activeNames="5"}},model:{value:e.form.mobileCode,callback:function(t){e.$set(e.form,"mobileCode",t)},expression:"form.mobileCode"}},[o("template",{slot:"append"},[o("get-code",{attrs:{isValidate:e.isValidateMobile,type:"mobile",identity:e.form.identity,mobile:e.form.mobile}})],1)],2)],1)],1),e._v(" "),o("btn-group",{staticClass:"mt_30",attrs:{activeNames:e.activeNames,isDisabled:e.isDisabled,index:"5"},on:{uodateUser:function(t){return e._updateUser(["mobile"],{mobile:e.form.mobile,mobileCode:e.form.mobileCode})},changeActive:function(t){e.activeNames="0"}}})],1)],2)],1)],1),e._ssrNode(' <div class="bottom-container ft_24 c_6 ft_b mt_50 " data-v-c9fc44fe>\n    其他\n  </div> '),e._ssrNode('<div class="cancel-group mt_30 ml_15 c_6 ft_18" data-v-c9fc44fe>',"</div>",[o("el-button",{attrs:{type:"danger"},on:{click:e._destoryUser}},[e._v("注销账户")])],1)],2)}),[],!1,(function(e){var t=o(117);t.__inject__&&t.__inject__(e)}),"c9fc44fe","5129f838");t.default=_.exports}};