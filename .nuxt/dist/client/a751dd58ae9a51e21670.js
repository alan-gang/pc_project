(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{332:function(e,t,n){"use strict";n(45);var r,o,c=n(6);t.a={data:function(){return{publicKey:"-----BEGIN PUBLIC KEY-----\nMFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAIGs2dvgRPJl/zMLAUeZgLP2ouCvuXcg\n65LI3KsUDl40UwATyxaX2ZxgytcrGFk8KRwcRiexEhbRlytedqbKVsMCAwEAAQ==\n-----END PUBLIC KEY-----",privateKey:"-----BEGIN RSA PRIVATE KEY-----\nMIIBOQIBAAJBAIGs2dvgRPJl/zMLAUeZgLP2ouCvuXcg65LI3KsUDl40UwATyxaX\n2ZxgytcrGFk8KRwcRiexEhbRlytedqbKVsMCAwEAAQJAdg98Dc5il1o7fSpQ0PI1\nliM/aVczgP1M3MfY+Dz7U9H5zzFHX3zasyFTu505i4Ia75DEU3Ik5MNAJsajC7Li\nKQIhANTmbAIJK0H5VPqYMvNKIPKcFcNghQzM5O6WCBx/Rff3AiEAm+1JhWfMQIXo\nzcH7yn4QWg6EjpfUK/Es3sWgp8seHJUCIACtz3BeOR4XvnaiH595AAvmBYe++g2l\nZaGBJvt4SG/XAiA2h4IppEYa3nmu00MB6po/VEppL5GkmGAvu/9WDsOGDQIgJdXi\n+Bf8g9tQUSeiK6kGqKeZfbA49Qot3NWxA/VxGXI=\n-----END RSA PRIVATE KEY-----",jsencrypt:function(){return n.e(16).then(n.t.bind(null,333,7))}}},methods:{_getPublicKey:(o=Object(c.a)(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.jsencrypt();case 2:return n=e.sent,r=n.JSEncrypt,(o=new r).setPublicKey(this.publicKey),e.abrupt("return",o.encrypt(t));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)}),_parsingKey:(r=Object(c.a)(regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.jsencrypt();case 2:return n=e.sent,r=n.JSEncrypt,(o=new r).setPrivateKey(this.privateKey),e.abrupt("return",o.decrypt(t));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})}}},339:function(e,t,n){},340:function(e,t,n){},343:function(e,t,n){"use strict";n(45);var r,o=n(6),c=n(133),l={mixins:[n(134).a],props:{identity:String,email:String,type:String,mobile:String,isValidate:Boolean},data:function(){return{isSend:!1,countDown:0,timer:null,url:null,msg:null,sendData:null}},methods:{_getCode:(r=Object(o.a)(regeneratorRuntime.mark((function e(){var t,code,data,n,r,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("email"==this.type?(this.msg="请先输入邮箱并确认身份",this.url=c.e,this.sendData={email:this.email,identity:this.identity}):(this.msg="请输入正确的手机号码",this.url=c.c,this.sendData={mobile:this.mobile,identity:this.identity}),this.isValidate&&this.identity){e.next=4;break}return this.alert(this.msg),e.abrupt("return");case 4:return this.isSend=!0,this.countDown=5,this.timer=setInterval((function(){if(o.countDown<1)return clearInterval(o.timer),void(o.isSend=!1);o.countDown--}),1e3),e.next=9,this.url(this.sendData);case 9:if(t=e.sent,code=t.code,data=t.data,n=t.status,r=t.message,401!=n){e.next=17;break}return this.alert("频率过快,绑定手机失败","warning"),e.abrupt("return");case 17:0===code?this.alert(data.msg,1==this.identity?"success":"warning"):this.alert(r,"warning");case 18:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})}},m=n(2),component=Object(m.a)(l,(function(){var e=this.$createElement;return(this._self._c||e)("el-button",{attrs:{type:"primary",loading:this.isSend},on:{click:this._getCode}},[this._v("\n  "+this._s(this.isSend?this.countDown+" 秒后从新获取":"发送"+("email"==this.type?"邮箱":"手机")+"验证码")+"\n")])}),[],!1,null,"d5683e86",null);t.a=component.exports},349:function(e,t,n){"use strict";var r=n(339);n.n(r).a},350:function(e,t,n){"use strict";var r=n(340);n.n(r).a},353:function(e,t,n){"use strict";n.r(t);n(46),n(45);var r,o,c=n(6),l=(n(20),n(134)),m=n(332),d=n(133),f=n(43),v=function(e){var data=localStorage[e]&&JSON.parse(localStorage[e]);return data||!1},h={props:{activeNames:String,isDisabled:Boolean,index:String}},w=(n(349),n(2)),_=Object(w.a)(h,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"btn-group mt_20"},[n("el-button",{attrs:{size:"small",type:"primary",disabled:e.activeNames==e.index&&e.isDisabled},on:{click:function(t){return e.$emit("uodateUser")}}},[e._v("确定")]),e._v(" "),n("el-button",{attrs:{size:"small"},on:{click:function(t){return e.$emit("changeActive")}}},[e._v("取消")])],1)}),[],!1,null,"36c8d4ad",null).exports,N=n(343),x={mixins:[l.a,m.a],components:{btnGroup:_,getCode:N.a},mounted:function(){var e=this;this.$nextTick((function(){e.useNameLogin=v("user").hasOwnProperty("accountName")}))},data:function(){return{activeNames:"0",isDisabled:!0,useNameLogin:!1,emailValidator:!1,isValidateMobile:!1,temporaryPassword:null,form:JSON.parse(JSON.stringify(this.$store.state.user.UserInfo)),isShowPassword:!1}},methods:{_updateUser:(o=Object(c.a)(regeneratorRuntime.mark((function e(t,data){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.every((function(e){return"success"===r.$refs[e].validateState}))){e.next=28;break}if(!data.password){e.next=12;break}return e.next=5,this._getPublicKey(data.password);case 5:return data.password=e.sent,e.next=8,this._getPublicKey(data.newPassword);case 8:this.temporaryPassword=data.newPassword=e.sent,this.form.oldPassword="",this.form.newPassword="",this.form.checkPassword="";case 12:return(data.accountName||this.temporaryPassword||this.form.email)&&this.isSaveUserName(t.length),e.next=15,Object(d.l)(data);case 15:if(1!=(n=e.sent).code){e.next=21;break}return 401===n.status?this.newLogin():this.alert(n.message),e.abrupt("return");case 21:sessionStorage.token=n.data.token,this.$store.commit("user/saveUserInfo",n.data.user),this.alert(n.data.msg,"success");case 24:this.activeNames="0",this.isDisabled=!0,e.next=29;break;case 28:this.alert("请检查表单后在进行数据提交");case 29:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)}),isSaveUserName:function(e){var t={accountName:this.form.accountName,email:this.form.email};e>1&&(t.password=this.temporaryPassword);var n,r,o=v("user");o&&o.hasOwnProperty("accountName")&&!this.useNameLogin&&(delete t.accountName,delete o.accountName),n="user",r=Object.assign(o||{password:this.form.password},t),"object"==Object(f.a)(r)?localStorage[n]=JSON.stringify(r):localStorage[n]=r},_destoryUser:(r=Object(c.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.prompt("此操作将永久删除用户信息,是否继续？",Object(c.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.b)({_id:t.$store.state.user.UserInfo._id});case 2:n=e.sent,r="user",localStorage.removeItem(r),0==n.code?(t.alert("删除用户成功","error",2e3),t.$router.replace("/user/register")):t.alert(n.message);case 5:case"end":return e.stop()}var r}),e)}))));case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},computed:{showErrorMessage:function(){return Boolean(this.activeNames)}}},y=(n(350),Object(w.a)(x,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"account-container w_840"},[n("el-form",{attrs:{"label-position":"top","label-width":"80px",model:e.form,"show-message":e.showErrorMessage,rules:e.rules}},[n("div",{staticClass:"title-container ft_24 c_6 ft_b mt_30 "},[e._v("账户与安全")]),e._v(" "),n("el-collapse",{attrs:{accordion:!0},on:{change:function(t){e.isDisabled=!0}},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[n("el-collapse-item",{staticClass:"mt_30",attrs:{name:"1"}},[n("template",{slot:"title"},[n("el-form-item",{ref:"accountName",staticClass:"w_100p",attrs:{prop:"accountName",label:"用户名"}},[n("el-input",{class:{on:"1"==e.activeNames},attrs:{"suffix-icon":"icon iconfont icon-write_fill",placeholder:"请输入用户名"},on:{input:function(t){e.isDisabled=!1,e.activeNames="1"}},model:{value:e.form.accountName,callback:function(t){e.$set(e.form,"accountName",t)},expression:"form.accountName"}})],1)],1),e._v(" "),n("div",{staticClass:"mt_25"},[n("div",{staticClass:"operate-container"},[n("el-switch",{attrs:{"active-text":"使用用户名作为登录凭证"},model:{value:e.useNameLogin,callback:function(t){e.useNameLogin=t},expression:"useNameLogin"}})],1),e._v(" "),n("btn-group",{attrs:{activeNames:e.activeNames,isDisabled:e.isDisabled,index:"1"},on:{uodateUser:function(t){return e._updateUser(["accountName"],{accountName:e.form.accountName})},changeActive:function(t){e.activeNames="0"}}})],1)],2),e._v(" "),n("el-collapse-item",{staticClass:"mt_30",attrs:{name:"2"}},[n("template",{slot:"title"},[n("el-form-item",{ref:"oldPassword",staticClass:"w_100p",attrs:{prop:"oldPassword",label:"密码"}},[n("el-input",{class:{on:"2"==e.activeNames},attrs:{"suffix-icon":"icon iconfont icon-write_fill",placeholder:"修改密码前需要输入当前密码",type:"password"},on:{input:function(t){e.isDisabled=!1,e.activeNames="2"}},model:{value:e.form.oldPassword,callback:function(t){e.$set(e.form,"oldPassword",t)},expression:"form.oldPassword"}})],1)],1),e._v(" "),n("div",{staticClass:"mt_25 "},[n("div",{staticClass:"operate-container"},[n("el-form-item",{ref:"newPassword",attrs:{prop:"newPassword"}},[n("el-input",{attrs:{type:e.isShowPassword?"text":"password",placeholder:"新密码"},on:{input:function(t){e.isDisabled=!1,e.activeNames="2"}},model:{value:e.form.newPassword,callback:function(t){e.$set(e.form,"newPassword",t)},expression:"form.newPassword"}},[n("span",{staticClass:"icon iconfont icon-eye ft_18 c_r",attrs:{slot:"suffix"},on:{click:function(t){e.isShowPassword=!e.isShowPassword}},slot:"suffix"})])],1),e._v(" "),n("el-form-item",{ref:"checkPassword",attrs:{prop:"checkPassword"}},[n("el-input",{attrs:{type:e.isShowPassword?"text":"password",placeholder:"确认新密码"},on:{input:function(t){e.isDisabled=!1,e.activeNames="2"}},model:{value:e.form.checkPassword,callback:function(t){e.$set(e.form,"checkPassword",t)},expression:"form.checkPassword"}},[n("span",{staticClass:"icon iconfont icon-eye ft_18 c_r",attrs:{slot:"suffix"},on:{click:function(t){e.isShowPassword=!e.isShowPassword}},slot:"suffix"})])],1)],1),e._v(" "),n("div",{staticClass:"flex  j_s "},[n("btn-group",{attrs:{activeNames:e.activeNames,isDisabled:e.isDisabled,index:"2"},on:{uodateUser:function(t){return e._updateUser(["oldPassword","newPassword","checkPassword"],{password:e.form.oldPassword,newPassword:e.form.newPassword})},changeActive:function(t){e.activeNames="0"}}}),e._v(" "),n("nuxt-link",{staticClass:"f_x_e ml_20 c_tc",attrs:{to:"/user/resetpassword"}},[e._v("忘记密码")])],1)])],2),e._v(" "),n("el-collapse-item",{staticClass:"mt_30",attrs:{name:"3"}},[n("template",{slot:"title"},[n("el-form-item",{ref:"nickName",staticClass:"w_100p",attrs:{label:"昵称",prop:"nickName"}},[n("el-input",{class:{on:"3"==e.activeNames},attrs:{"suffix-icon":"icon iconfont icon-write_fill",placeholder:"请输入用户昵称"},on:{input:function(t){e.isDisabled=!1,e.activeNames="3"}},model:{value:e.form.nickName,callback:function(t){e.$set(e.form,"nickName",t)},expression:"form.nickName"}})],1)],1),e._v(" "),n("btn-group",{staticClass:"mt_30",attrs:{activeNames:e.activeNames,isDisabled:e.isDisabled,index:"3"},on:{uodateUser:function(t){return e._updateUser(["nickName"],{nickName:e.form.nickName})},changeActive:function(t){e.activeNames="0"}}})],2),e._v(" "),n("el-collapse-item",{staticClass:"mt_30",attrs:{name:"4"}},[n("template",{slot:"title"},[n("el-form-item",{ref:"email",staticClass:"w_100p",attrs:{label:"绑定邮箱",prop:"email"}},[n("el-input",{class:{on:"4"==e.activeNames},attrs:{"suffix-icon":"icon iconfont icon-write_fill",placeholder:"请输入需要修改的邮箱"},on:{input:function(t){e.isDisabled=!1,e.activeNames="4"}},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1)],1),e._v(" "),n("div",{staticClass:"mt_25 "},[n("div",{staticClass:"operate-container"},[n("el-form-item",{attrs:{prop:"code"}},[n("el-input",{attrs:{placeholder:"请输入获取到的验证码"},on:{input:function(t){e.isDisabled=!1,e.activeNames="4"}},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}},[n("template",{slot:"append"},[n("get-code",{attrs:{isValidate:e.emailValidator,type:"email",identity:e.form.identity,email:e.form.email}})],1)],2)],1)],1),e._v(" "),n("btn-group",{staticClass:"mt_30",attrs:{activeNames:e.activeNames,isDisabled:e.isDisabled,index:"4"},on:{uodateUser:function(t){return e._updateUser(["email"],{email:e.form.email})},changeActive:function(t){e.activeNames="0"}}})],1)],2),e._v(" "),n("el-collapse-item",{staticClass:"mt_30",attrs:{name:"5"}},[n("template",{slot:"title"},[n("el-form-item",{ref:"mobile",staticClass:"w_100p",attrs:{label:"手机号码",prop:"mobile"}},[n("el-input",{class:{on:"5"==e.activeNames},attrs:{"suffix-icon":"icon iconfont icon-write_fill",placeholder:"请输入手机号码"},on:{input:function(t){e.isDisabled=!1,e.activeNames="5"}},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1)],1),e._v(" "),n("div",{staticClass:"mt_30 "},[n("div",{staticClass:"operate-container"},[n("el-form-item",{attrs:{prop:"mobileCode"}},[n("el-input",{attrs:{placeholder:"请输入获取到的验证码"},on:{input:function(t){e.isDisabled=!1,e.activeNames="5"}},model:{value:e.form.mobileCode,callback:function(t){e.$set(e.form,"mobileCode",t)},expression:"form.mobileCode"}},[n("template",{slot:"append"},[n("get-code",{attrs:{isValidate:e.isValidateMobile,type:"mobile",identity:e.form.identity,mobile:e.form.mobile}})],1)],2)],1)],1),e._v(" "),n("btn-group",{staticClass:"mt_30",attrs:{activeNames:e.activeNames,isDisabled:e.isDisabled,index:"5"},on:{uodateUser:function(t){return e._updateUser(["mobile"],{mobile:e.form.mobile,mobileCode:e.form.mobileCode})},changeActive:function(t){e.activeNames="0"}}})],1)],2)],1)],1),e._v(" "),n("div",{staticClass:"bottom-container ft_24 c_6 ft_b mt_50 "},[e._v("\n    其他\n  ")]),e._v(" "),n("div",{staticClass:"cancel-group mt_30 ml_15 c_6 ft_18"},[n("el-button",{attrs:{type:"danger"},on:{click:e._destoryUser}},[e._v("注销账户")])],1)],1)}),[],!1,null,"69ca0e5e",null));t.default=y.exports}}]);